name: Update Metrics

on:
  workflow_dispatch: # run manually from actions tab
  schedule:
  - cron: 0 0 * * 1 # run once a week at monday midnight

permissions:
  contents: read

jobs:
  update-metrics:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      # Ref: https://github.com/lowlighter/metrics/blob/master/action.yml
      - uses: lowlighter/metrics@65836723097537a54cd8eb90f61839426b4266b6 # v3.34
        with:
          token: ${{ secrets.METRICS_TOKEN }}
          filename: images/metrics.svg
          committer_message: "chore: update github-metrics\n\nAutomatically generated by lowlighter/metrics [skip ci]"
          config_timezone: Europe/Berlin
          base_hireable: false
          base: header, activity, community, repositories, metadata
          plugin_languages: true
          user: afuetterer
          # Ref: https://github.com/lowlighter/metrics/blob/master/source/plugins/core/README.md#advanced-pattern-matching
          repositories_skipped: |
            @use.patterns
            -afuetterer/*
            +afuetterer/oaipmh-scythe
